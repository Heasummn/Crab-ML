OASISFormat: 0.4
Name:        Crab
Version:     0.0.1
Synopsis:    A simple compiler as an educational project
Authors:     Heasummn
License:     MIT
Plugins:     META (0.4), DevFiles (0.4)
BuildTools:  ocamlbuild
AlphaFeatures: ocamlbuild_more_args
XOCamlbuildExtraArgs: '-use-menhir -menhir "menhir --table"'

Library "Crab"
  Path:             src
  Modules:          Crab

Library "CrabAst"
  FindLibParent:    Crab
  Path:             src/CrabAst
  Modules:          CrabAst
  BuildDepends:     Crab.CrabCommon

Library "CrabCodegen"
  FindLibParent:    Crab
  Path:             src/CrabCodegen
  Modules:          CrabCodegen
  BuildDepends:     Crab.CrabAst, llvm

Library "CrabCommon"
  FindLibParent:    Crab
  Path:             src/CrabCommon
  Modules:          Error, Location, Types

Library "CrabParsing"
  FindLibParent:    Crab
  Path:             src/CrabParsing
  Modules:          CrabParsing, Lexer, Parser
  BuildDepends:     menhirLib, Crab.CrabAst, Crab.CrabCommon
  BuildTools+:      menhir

Library "CrabSemantic"
  FindLibParent:    Crab
  Path:             src/CrabSemantic
  Modules:          CrabSemantic, AnalyzeTp
  BuildDepends:     Crab.CrabAst, Crab.CrabCommon

Executable "crab"
  Path:             src
  MainIs:           crab.ml
  Install:          true
  CompiledObject:   best
  BuildDepends:     Crab.CrabCodegen, Crab.CrabParsing, Crab.CrabCommon, Crab.CrabSemantic

Executable test_lexing
  Path:             test/lexing
  Build$:           flag(tests)
  Install:          false
  CompiledObject:   best
  MainIs:           test_lex.ml
  BuildDepends:     oUnit, str, batteries, Crab.CrabParsing

Test "lexing"
  Command:          $test_lexing
  TestTools:        test_lexing
  Run$: flag(tests)